# Story 3.8: Implement AI Component Streaming (Law Cards, Task Suggestions)

## Status

Draft

## Story

**As a** user,
**I want** the AI to suggest law cards or tasks directly in the chat,
**so that** I can take action without leaving the conversation.

## Acceptance Criteria

1. LLM prompt includes tool/function calling for components
2. AI can stream back components: `law_card`, `task_suggestion`, `employee_suggestion`
3. Frontend renders streamed components as interactive cards in chat
4. Law card includes: title, category, "Add to list" button
5. Task suggestion includes: title, description, "Create task" button
6. Clicking "Add to list" adds law to user's workspace (requires Epic 5)
7. Clicking "Create task" opens task creation modal (requires Epic 6)
8. Component streaming uses Vercel AI SDK tool calling
9. Example: "What HR laws apply to restaurants?" â†’ AI streams 5 law cards
10. Mobile-responsive component rendering

## Tasks / Subtasks

- [ ] Define AI tools/functions
- [ ] Implement component streaming
- [ ] Create interactive card components
- [ ] Wire up action buttons
- [ ] Test component rendering

## Dev Notes

**AI Tool Definition:**

```typescript
const tools = {
  suggest_law: {
    description: 'Suggest a relevant law to the user',
    parameters: {
      law_id: 'string',
      title: 'string',
      category: 'string',
      reason: 'string',
    },
  },
  suggest_task: {
    description: 'Suggest a compliance task',
    parameters: {
      title: 'string',
      description: 'string',
      linked_law_id: 'string',
    },
  },
}
```

**Streaming Components with Vercel AI SDK:**

```typescript
import { useChat } from 'ai/react'

const { messages } = useChat({
  api: '/api/chat/query',
  experimental_onToolCall: async (toolCall) => {
    if (toolCall.toolName === 'suggest_law') {
      return <LawCardSuggestion {...toolCall.args} />
    }
  }
})
```

**Reference:** Architecture Section 5.2 (Server Actions), Vercel AI SDK docs

## Change Log

| Date       | Version | Description            | Author     |
| ---------- | ------- | ---------------------- | ---------- |
| 2025-11-11 | 1.0     | Initial story creation | Sarah (PO) |

## Dev Agent Record

_To be populated by dev agent_

## QA Results

_To be populated by QA agent_
