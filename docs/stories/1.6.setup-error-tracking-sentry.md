# Story 1.6: Set Up Error Tracking and Logging (Sentry)

## Status
Draft

## Story

**As a** developer,
**I want** to automatically capture errors in production,
**so that** I can debug issues without manual reports.

## Acceptance Criteria

1. Sentry account created
2. Sentry SDK installed
3. Sentry initialized in client and server configs
4. Source maps uploaded to Sentry
5. Test error captured successfully in dashboard
6. Error reports include: stack trace, user context, environment
7. Email alerts for critical errors
8. Sentry integrated with Vercel

## Tasks / Subtasks

- [ ] Create Sentry account and project
  - [ ] Sign up at sentry.io (free tier)
  - [ ] Create "laglig-se" project
  - [ ] Copy DSN key

- [ ] Install and configure Sentry SDK
  - [ ] Install: `npm install @sentry/nextjs`
  - [ ] Run setup wizard: `npx @sentry/wizard@latest -i nextjs`
  - [ ] Configure `sentry.client.config.ts`
  - [ ] Configure `sentry.server.config.ts`
  - [ ] Configure `sentry.edge.config.ts`

- [ ] Configure source maps upload
  - [ ] Add SENTRY_AUTH_TOKEN to Vercel environment
  - [ ] Enable source maps in `next.config.js`
  - [ ] Test upload during build

- [ ] Test error capture
  - [ ] Create test error endpoint: `/api/test-error`
  - [ ] Trigger error and verify in Sentry dashboard
  - [ ] Check user context, breadcrumbs, environment

- [ ] Configure alerts
  - [ ] Set up email alerts for critical errors
  - [ ] Configure Slack integration (optional)
  - [ ] Set alert thresholds

## Dev Notes

### Sentry Configuration

**sentry.client.config.ts:**
```typescript
import * as Sentry from '@sentry/nextjs'

Sentry.init({
  dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,
  environment: process.env.NODE_ENV,
  tracesSampleRate: 0.1,
  replaysSessionSampleRate: 0.1,
  replaysOnErrorSampleRate: 1.0,
})
```

**Reference:** Architecture Section 19 (Monitoring and Observability)

### Testing
Manual verification of error capture. Test endpoint: `/api/test-error`

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-11-11 | 1.0 | Initial story creation | Sarah (PO) |

## Dev Agent Record
_To be populated by dev agent_

## QA Results
_To be populated by QA agent_
