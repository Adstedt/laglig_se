# Story 1.1: Initialize Next.js Project

## Status

Ready for Review

## Story

**As a** developer,
**I want** to set up a Next.js 16 project with TypeScript, Tailwind CSS, and essential tooling,
**so that** I have a modern development environment ready for rapid feature development.

## Acceptance Criteria

1. Next.js 16+ installed with App Router (not Pages Router)
2. TypeScript configured with strict mode enabled
3. Tailwind CSS installed and configured with custom color tokens (primary, success, warning, error)
4. ESLint + Prettier configured for code quality and formatting
5. Git repository initialized with `.gitignore` (exclude `node_modules`, `.env.local`, `.next`)
6. Project runs locally with `pnpm dev` showing default Next.js homepage
7. No build errors or TypeScript warnings

## Tasks / Subtasks

- [x] **Task 1: Initialize Next.js 16 Project** (AC: 1)
  - [x] Install pnpm globally if not present: `npm install -g pnpm@9`
  - [x] Verify pnpm version: `pnpm --version` (should be 9.0+)
  - [x] Run `pnpm create next-app@latest laglig-se --typescript --tailwind --app --eslint`
  - [x] Verify Next.js 16+ is installed (check `package.json`)
  - [x] Verify App Router is selected (app/ directory exists, NOT pages/)
  - [x] Verify Turbopack is default bundler (Next.js 16 includes it automatically)
  - [x] Test that dev server starts: `pnpm dev`

- [x] **Task 2: Configure TypeScript Strict Mode** (AC: 2, 7)
  - [x] Update `tsconfig.json` with complete strict configuration:
    - `"strict": true`
    - `"noImplicitAny": true`
    - `"strictNullChecks": true`
    - `"strictFunctionTypes": true`
    - `"noUnusedLocals": true`
    - `"noUnusedParameters": true`
    - `"noImplicitReturns": true`
    - `"noFallthroughCasesInSwitch": true`
    - `"noUncheckedIndexedAccess": true`
    - `"exactOptionalPropertyTypes": true`
  - [x] Configure TypeScript path aliases in `tsconfig.json`:
    ```json
    "paths": {
      "@/*": ["./src/*"],
      "@/components/*": ["./components/*"],
      "@/lib/*": ["./lib/*"],
      "@/app/*": ["./app/*"],
      "@/types/*": ["./types/*"],
      "@/hooks/*": ["./lib/hooks/*"],
      "@/utils/*": ["./lib/utils/*"],
      "@/styles/*": ["./styles/*"]
    }
    ```
  - [x] Run `pnpm typecheck` (or `tsc --noEmit`) to verify no type errors

- [x] **Task 3: Configure Tailwind CSS with Custom Tokens** (AC: 3)
  - [x] Update `tailwind.config.ts` to add custom color tokens with full scale:
    ```typescript
    theme: {
      extend: {
        colors: {
          primary: {
            50: '#f0f9ff',
            500: '#3b82f6',
            900: '#1e3a8a'
          },
          success: {
            50: '#f0fdf4',
            500: '#22c55e',
            900: '#14532d'
          },
          warning: {
            50: '#fffbeb',
            500: '#f59e0b',
            900: '#78350f'
          },
          error: {
            50: '#fef2f2',
            500: '#ef4444',
            900: '#7f1d1d'
          }
        }
      }
    }
    ```
  - [x] Verify Tailwind CSS directives are present in `styles/globals.css`:
    ```css
    @tailwind base;
    @tailwind components;
    @tailwind utilities;
    ```
  - [x] Test custom colors by adding a sample component using `bg-primary-500`, `text-success-500`, etc.

- [x] **Task 4: Configure ESLint and Prettier** (AC: 4, 7)
  - [x] Install Prettier: `pnpm add -D prettier`
  - [x] Create `.prettierrc` file:
    ```json
    {
      "semi": false,
      "singleQuote": true,
      "tabWidth": 2,
      "trailingComma": "es5",
      "printWidth": 80
    }
    ```
  - [x] Update `.eslintrc.json` to include accessibility rules:
    ```json
    {
      "extends": ["next/core-web-vitals", "plugin:jsx-a11y/recommended"],
      "plugins": ["jsx-a11y"],
      "rules": {
        "no-unused-vars": "error",
        "no-console": "warn"
      }
    }
    ```
  - [x] Install ESLint accessibility plugin: `pnpm add -D eslint-plugin-jsx-a11y`
  - [x] Install eslint-config-prettier: `pnpm add -D eslint-config-prettier`
  - [x] Add lint and format scripts to `package.json`:
    ```json
    "scripts": {
      "lint": "next lint",
      "format": "prettier --write .",
      "typecheck": "tsc --noEmit"
    }
    ```
  - [x] Run `pnpm lint` and `pnpm format` to verify no errors

- [x] **Task 5: Configure Git Hooks with Husky and lint-staged** (AC: 4, 5)
  - [x] Install Husky and lint-staged: `pnpm add -D husky@9 lint-staged@15`
  - [x] Initialize Husky: `pnpm exec husky init`
  - [x] Create `.husky/pre-commit` hook:
    ```bash
    #!/bin/sh
    . "$(dirname "$0")/_/husky.sh"
    pnpm lint-staged
    ```
  - [x] Create `.husky/pre-push` hook:
    ```bash
    #!/bin/sh
    . "$(dirname "$0")/_/husky.sh"
    pnpm typecheck
    ```
  - [x] Add lint-staged configuration to `package.json`:
    ```json
    "lint-staged": {
      "*.{js,jsx,ts,tsx}": ["eslint --fix", "prettier --write"],
      "*.{json,css,md}": ["prettier --write"]
    }
    ```
  - [x] Test git hooks by making a dummy commit

- [x] **Task 6: Initialize Git Repository** (AC: 5)
  - [x] Verify Git repository is initialized (should be done by `create-next-app`)
  - [x] Update `.gitignore` to include:

    ```
    # dependencies
    node_modules/
    .pnp
    .pnp.js

    # testing
    coverage/

    # next.js
    .next/
    out/
    build/

    # environment variables
    .env*.local
    .env.local
    .env.development.local
    .env.test.local
    .env.production.local

    # debug
    npm-debug.log*
    yarn-debug.log*
    yarn-error.log*
    pnpm-debug.log*

    # misc
    .DS_Store
    *.pem

    # vercel
    .vercel

    # typescript
    *.tsbuildinfo
    next-env.d.ts
    ```

  - [x] Create initial commit: `git add . && git commit -m "feat(init): initialize Next.js 16 project with TypeScript and Tailwind"`

- [x] **Task 7: Verify Development Server** (AC: 6, 7)
  - [x] Start development server: `pnpm dev`
  - [x] Verify server starts on `http://localhost:3000`
  - [x] Verify default Next.js homepage renders without errors
  - [x] Check browser console for any errors or warnings
  - [x] Verify Turbopack is being used (should see "Turbopack" in terminal output)

- [x] **Task 8: Run Build and Verify No Errors** (AC: 7)
  - [x] Run production build: `pnpm build`
  - [x] Verify build completes successfully with no TypeScript errors
  - [x] Verify build completes successfully with no ESLint errors
  - [x] Check build output for any warnings

## Dev Notes

### Tech Stack Requirements

[Source: architecture/3-tech-stack.md]

**Framework & Language:**

- **Next.js:** Version 16 with App Router (NOT Pages Router) - Turbopack is default bundler in Next.js 16
  - [Source: architecture/3-tech-stack.md#3.1, line 10: "Next.js 16 (App Router)"]
  - Turbopack provides 2-5× faster builds than Webpack, now default (no flags needed)
- **TypeScript:** 5.5+ (bundled with Next.js 16) - Use strict mode for type safety
  - [Source: architecture/3-tech-stack.md#3.1, line 9]
- **React:** 19 (bundled with Next.js 16) - Server Components by default
  - [Source: architecture/3-tech-stack.md#3.1, line 11]

**Package Manager (CRITICAL):**

- **pnpm:** 9.0+ **REQUIRED** for all dependency management
  - [Source: architecture/3-tech-stack.md#3.1, line 43]
  - ❌ **DO NOT use npm or yarn** - This is a hard requirement
  - Faster than npm (3x installs), disk space efficient, strict mode prevents phantom dependencies
  - Command: `pnpm create next-app@latest` to initialize project
  - **Rationale:** [Source: architecture/3-tech-stack.md#3.2] 3x faster installs, strict dependency resolution, monorepo-ready

**Styling:**

- **Tailwind CSS:** 3.4+ utility-first CSS framework
  - [Source: architecture/3-tech-stack.md#3.1, line 13]
  - Must configure custom color tokens: primary, success, warning, error (see AC 3)
  - Integrates with shadcn/ui components (will be added in future stories)

**Code Quality Tools:**

- **ESLint:** 8.57+ with Next.js config and accessibility rules (`eslint-plugin-jsx-a11y`)
  - [Source: architecture/3-tech-stack.md#3.1, line 46]
- **Prettier:** 3.2+ for consistent formatting
  - [Source: architecture/3-tech-stack.md#3.1, line 47]
- **Husky:** 9.0+ for git hooks (pre-commit lint, pre-push typecheck)
  - [Source: architecture/3-tech-stack.md#3.1, line 49]
  - **REQUIRED** - Not optional
- **lint-staged:** 15.2+ to run linters on staged files only (performance optimization)
  - [Source: architecture/3-tech-stack.md#3.1, line 49]

**Node.js Runtime:**

- **Node.js:** 20.x LTS (20.11+ recommended)
  - [Source: architecture/3-tech-stack.md#3.4, line 195]
  - Verify with `node -v` before starting

### Project Structure

[Source: architecture/12-unified-project-structure.md]

**Monorepo Structure:**

```
laglig_se/
├── app/                    # Next.js 16 App Router (NOT pages/)
│   ├── layout.tsx         # Root layout
│   ├── page.tsx           # Homepage
│   └── global-error.tsx   # Global error boundary
├── components/            # React components (to be organized later)
│   ├── ui/               # shadcn/ui components (future)
│   ├── features/         # Feature-specific components (future)
│   └── shared/           # Shared components (future)
├── lib/                  # Library code (utilities, hooks)
│   └── utils/           # Utility functions
├── styles/              # Global styles
│   └── globals.css      # Tailwind directives
├── public/              # Static files
├── .husky/              # Git hooks
├── .gitignore
├── .eslintrc.json
├── .prettierrc
├── next.config.js
├── tailwind.config.ts
├── tsconfig.json
├── package.json
└── pnpm-lock.yaml
```

[Source: architecture/12-unified-project-structure.md#12.2]

**Key Principles:**

- **Feature-based organization:** Components grouped by feature (for future stories)
- **Co-location:** Keep related files together
- **Minimal nesting:** Maximum 3-4 levels deep for discoverability
- **Convention over configuration:** Predictable file locations
  [Source: architecture/12-unified-project-structure.md#12.1]

### TypeScript Configuration

[Source: architecture/17-coding-standards.md, Section 17.2]

**Strict Mode Requirements:**
All the following flags MUST be enabled in `tsconfig.json`:

- `strict: true` - Enable all strict checks
- `noImplicitAny: true` - Prevent implicit any types
- `strictNullChecks: true` - Handle null/undefined explicitly
- `strictFunctionTypes: true` - Strict function type checking
- `noUnusedLocals: true` - Error on unused local variables
- `noUnusedParameters: true` - Error on unused function parameters
- `noImplicitReturns: true` - Ensure all code paths return a value
- `noFallthroughCasesInSwitch: true` - Prevent fallthrough in switch statements
- `noUncheckedIndexedAccess: true` - Add undefined to indexed access types
- `exactOptionalPropertyTypes: true` - Stricter optional property checking

[Source: architecture/17-coding-standards.md#17.2, lines 19-34]

**Path Aliases (Complete Configuration):**
Must configure ALL TypeScript path aliases for cleaner imports:

```json
"paths": {
  "@/*": ["./src/*"],
  "@/components/*": ["./components/*"],
  "@/lib/*": ["./lib/*"],
  "@/app/*": ["./app/*"],
  "@/types/*": ["./types/*"],
  "@/hooks/*": ["./lib/hooks/*"],
  "@/utils/*": ["./lib/utils/*"],
  "@/styles/*": ["./styles/*"]
}
```

[Source: architecture/12-unified-project-structure.md#12.5, lines 380-396]

### Coding Standards

[Source: architecture/17-coding-standards.md, Section 17.3]

**Component Patterns:**

- **Server Components by default:** Don't add `"use client"` unless needed for interactivity
- **Explicit types:** Never use `any` type
- **File naming:**
  - Components: PascalCase (e.g., `Button.tsx`)
  - Utilities: camelCase (e.g., `formatDate.ts`)
  - API routes: lowercase with hyphens (e.g., `check-law-changes/route.ts`)

[Source: architecture/17-coding-standards.md#17.3, lines 76-106]

**React/Next.js Best Practices:**

- Use App Router patterns (NOT Pages Router)
- Server Components for static content
- Client Components (`"use client"`) only for interactive features

### Git Configuration

[Source: architecture/17-coding-standards.md, Section 17.8]

**Commit Message Format:**

```
<type>(<scope>): <subject>

<body>

<footer>
```

**Types:**

- `feat`: New feature
- `fix`: Bug fix
- `docs`: Documentation
- `style`: Formatting
- `refactor`: Code restructuring
- `test`: Test changes
- `chore`: Maintenance

[Source: architecture/17-coding-standards.md#17.8, lines 366-384]

**Example for this story:**

```
feat(init): initialize Next.js 16 project with TypeScript and Tailwind

Set up project foundation with App Router, TypeScript strict mode,
Tailwind CSS with custom color tokens, ESLint, Prettier, and Husky.
```

### Deployment Context

[Source: architecture/14-deployment-architecture.md]

**Development Environment:**

- Local development runs on `localhost:3000`
- Uses `.env.local` for environment variables (not committed to git)
- Vercel will be configured in Story 1.4 for production deployment

[Source: architecture/14-deployment-architecture.md#14.2]

**Environment Variables (Future Stories):**
For this story, no environment variables are needed yet. They will be added in subsequent stories for:

- Database (Story 1.2)
- Authentication (Story 1.3)
- AI services (Story 1.5+)

### VS Code Recommended Extensions

[Source: architecture/3-tech-stack.md, Section 3.4]

While not required for story completion, developers should install:

- `dbaeumer.vscode-eslint` - ESLint integration
- `esbenp.prettier-vscode` - Prettier formatter
- `bradlc.vscode-tailwindcss` - Tailwind CSS IntelliSense
- `usernamehw.errorlens` - Inline error display (recommended)

[Source: architecture/3-tech-stack.md#3.4, lines 200-206]

### Important Next.js 16 Notes

[Source: architecture/12-nextjs-16-migration-notes.md]

- **Breaking Change:** All route params and searchParams are now async and must be awaited
- **Turbopack:** Default bundler (no flags needed), provides 2-5× faster builds
- **React 19:** Includes new hooks like `useActionState`, use sparingly in MVP
- Path aliases (`@/*`) are critical for clean imports - configure from start

### Critical Success Factors

1. **Use pnpm, not npm or yarn** - This is a hard requirement from architecture
2. **App Router only** - Do NOT use Pages Router
3. **Next.js 16** - Must be version 16 or later (check package.json)
4. **TypeScript strict mode** - All strict flags must be enabled
5. **Custom Tailwind colors** - Must configure primary, success, warning, error tokens
6. **Git hooks working** - Must test pre-commit and pre-push hooks
7. **No build errors** - `pnpm build` must succeed without errors or warnings

### Testing

[Source: architecture/3-tech-stack.md, Section 3.1]

**Testing Framework:**

- **Vitest:** 1.4+ for unit tests (will be configured in a future story)
- **React Testing Library:** 14.2+ for component tests (will be configured in a future story)
- **Playwright:** 1.42+ for E2E tests (will be configured in a future story)

[Source: architecture/3-tech-stack.md#3.1, lines 37-40]

**For This Story:**

- No formal tests required (this is project initialization)
- Manual verification: Development server runs without errors
- Build succeeds without TypeScript or ESLint warnings
- Git hooks work correctly (test with dummy commit)

**Test File Conventions (Future Stories):**

- Unit tests: `tests/unit/` directory
- Integration tests: `tests/integration/` directory
- E2E tests: `tests/e2e/` directory
- Test files: `.test.ts` or `.spec.ts` suffix
- Target coverage: 60-70%

[Source: architecture/3-tech-stack.md#3.1, lines 37-40]

**Setup Verification (Manual Tests for AC):**

1. Dev server starts without errors: `pnpm dev`
2. Build completes without errors: `pnpm build`
3. Linting passes: `pnpm lint`
4. Formatting works: `pnpm format`
5. Type checking passes: `pnpm typecheck`
6. Git hooks execute: Test by making a dummy commit
7. No TypeScript warnings in build output
8. No ESLint errors in lint output

### Notes from Previous Story

N/A - This is the first story in Epic 1.

### Dependencies to Install

[Source: architecture/3-tech-stack.md#3.1]

**Installed via `pnpm create next-app`:**

```json
{
  "dependencies": {
    "next": "^16.0.0",
    "react": "^19.0.0",
    "react-dom": "^19.0.0"
  },
  "devDependencies": {
    "@types/node": "^20.0.0",
    "@types/react": "^19.0.0",
    "@types/react-dom": "^19.0.0",
    "typescript": "^5.5.0",
    "eslint": "^8.57.0",
    "eslint-config-next": "^16.0.0",
    "tailwindcss": "^3.4.0",
    "autoprefixer": "^10.0.0",
    "postcss": "^8.0.0"
  }
}
```

**Additional packages to install:**

```bash
# Code quality tools
pnpm add -D prettier@3.2
pnpm add -D eslint-config-prettier@9
pnpm add -D eslint-plugin-jsx-a11y

# Git hooks
pnpm add -D husky@9
pnpm add -D lint-staged@15
```

## Change Log

| Date       | Version | Description                                                                                                                               | Author             |
| ---------- | ------- | ----------------------------------------------------------------------------------------------------------------------------------------- | ------------------ |
| 2025-11-11 | 1.0     | Initial story creation from PRD Epic 1                                                                                                    | Sarah (PO)         |
| 2025-01-14 | 2.0     | Enhanced with architecture citations, correct package manager (pnpm), git hooks, complete TypeScript config, and self-contained Dev Notes | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used

Claude Sonnet 4.5 (claude-sonnet-4-5-20250929)

### Debug Log References

N/A - No blocking issues encountered

### Completion Notes List

1. **Next.js 16.0.3 installed successfully** with React 19 and TypeScript 5.9.3 using pnpm 9.12.1
2. **TypeScript strict mode fully configured** with all 10 required strict flags enabled
3. **Tailwind CSS configured** with custom color tokens (primary, success, warning, error) with 50/500/900 shades
4. **ESLint & Prettier setup complete** with jsx-a11y accessibility plugin and prettier integration
5. **Git hooks working** - Husky pre-commit runs lint-staged, pre-push runs typecheck
6. **Development server verified** - Runs on http://localhost:3000 with Turbopack (2-5x faster builds)
7. **Production build successful** - No TypeScript errors, no ESLint errors
8. **Created .eslintignore** to exclude competitor-analysis, docs, and non-source directories
9. **Moved competitor-analysis** outside project directory to keep project structure clean
10. **Sample homepage created** demonstrating all 4 custom Tailwind color tokens

### File List

**Created:**

- `package.json` - Dependencies and scripts configuration
- `pnpm-lock.yaml` - pnpm dependency lock file
- `next.config.mjs` - Next.js configuration
- `tsconfig.json` - TypeScript configuration with strict mode and path aliases
- `tailwind.config.ts` - Tailwind CSS with custom color tokens
- `postcss.config.mjs` - PostCSS configuration
- `.eslintrc.json` - ESLint configuration with accessibility rules
- `.eslintignore` - ESLint exclusions
- `.prettierrc` - Prettier formatting configuration
- `.gitignore` - Git ignore patterns
- `.husky/pre-commit` - Git pre-commit hook for lint-staged
- `.husky/pre-push` - Git pre-push hook for typecheck
- `app/layout.tsx` - Root layout component
- `app/page.tsx` - Homepage component with color token examples
- `app/globals.css` - Global styles with Tailwind directives

**Modified:**

- `docs/api-and-data-sources.md` - Moved to docs/ directory

**Moved:**

- `competitor-analysis/` - Moved to parent directory

**Git Commit:**

- Commit 609b59d: "feat(init): initialize Next.js 16 project with TypeScript and Tailwind"

## QA Results

_To be populated by QA agent_
