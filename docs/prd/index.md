# Laglig.se Product Requirements Document (PRD)

## Table of Contents

- [Laglig.se Product Requirements Document (PRD)](#table-of-contents)
  - [Changelog](./changelog.md)
    - [Version 1.3 (2025-11-03)](./changelog.md#version-13-2025-11-03)
    - [Version 1.2 (2025-11-02)](./changelog.md#version-12-2025-11-02)
    - [Version 1.1 (2025-11-01)](./changelog.md#version-11-2025-11-01)
    - [Version 1.0 (2025-01-01)](./changelog.md#version-10-2025-01-01)
  - [Goals and Background Context](./goals-and-background-context.md)
    - [Goals](./goals-and-background-context.md#goals)
    - [Background Context](./goals-and-background-context.md#background-context)
      - [The Problem We're Solving](./goals-and-background-context.md#the-problem-were-solving)
      - [Why Existing Solutions Fall Short](./goals-and-background-context.md#why-existing-solutions-fall-short)
      - [Our Approach](./goals-and-background-context.md#our-approach)
      - [Strategic Context](./goals-and-background-context.md#strategic-context)
      - [User Research & Validation Approach](./goals-and-background-context.md#user-research-validation-approach)
    - [Change Log](./goals-and-background-context.md#change-log)
  - [Requirements](./requirements.md)
    - [Functional Requirements](./requirements.md#functional-requirements)
    - [Non-Functional Requirements](./requirements.md#non-functional-requirements)
  - [User Interface Design Goals](./user-interface-design-goals.md)
    - [Overall UX Vision](./user-interface-design-goals.md#overall-ux-vision)
    - [Key Interaction Paradigms](./user-interface-design-goals.md#key-interaction-paradigms)
      - [1. Drag-and-Drop Context Building](./user-interface-design-goals.md#1-drag-and-drop-context-building)
      - [2. Streaming Intelligence](./user-interface-design-goals.md#2-streaming-intelligence)
      - [3. Task-Centric Compliance Workflow](./user-interface-design-goals.md#3-task-centric-compliance-workflow)
      - [4. Inline Contextual Help](./user-interface-design-goals.md#4-inline-contextual-help)
      - [5. Citation-First AI Responses](./user-interface-design-goals.md#5-citation-first-ai-responses)
    - [Core Screens and Views](./user-interface-design-goals.md#core-screens-and-views)
    - [Accessibility](./user-interface-design-goals.md#accessibility)
    - [Branding](./user-interface-design-goals.md#branding)
    - [Design System & Components](./user-interface-design-goals.md#design-system-components)
      - [Component Library Approach](./user-interface-design-goals.md#component-library-approach)
      - [Standardized UI Patterns](./user-interface-design-goals.md#standardized-ui-patterns)
      - [Design Handoff Requirements](./user-interface-design-goals.md#design-handoff-requirements)
    - [Target Device and Platforms](./user-interface-design-goals.md#target-device-and-platforms)
  - [Technical Assumptions](./technical-assumptions.md)
    - [Repository Structure: Monorepo](./technical-assumptions.md#repository-structure-monorepo)
    - [Service Architecture: Monolith (Serverless Functions)](./technical-assumptions.md#service-architecture-monolith-serverless-functions)
    - [Testing Requirements: Unit + Integration](./technical-assumptions.md#testing-requirements-unit-integration)
    - [Frontend Stack](./technical-assumptions.md#frontend-stack)
    - [Backend Stack](./technical-assumptions.md#backend-stack)
    - [AI Stack](./technical-assumptions.md#ai-stack)
    - [Email System](./technical-assumptions.md#email-system)
    - [Monitoring & Observability](./technical-assumptions.md#monitoring-observability)
    - [CI/CD & Deployment](./technical-assumptions.md#cicd-deployment)
    - [Security & Compliance](./technical-assumptions.md#security-compliance)
    - [Technical Risk Areas Requiring Architect Deep-Dive](./technical-assumptions.md#technical-risk-areas-requiring-architect-deep-dive)
      - [1. RAG Implementation & Accuracy Tuning](./technical-assumptions.md#1-rag-implementation-accuracy-tuning)
      - [2. Multi-Source API Dependencies (Riksdagen, Domstolsverket, EUR-Lex) & Reliability](./technical-assumptions.md#2-multi-source-api-dependencies-riksdagen-domstolsverket-eur-lex-reliability)
      - [3. Vector Database Scaling Triggers](./technical-assumptions.md#3-vector-database-scaling-triggers)
      - [4. Real-Time Drag-and-Drop Performance](./technical-assumptions.md#4-real-time-drag-and-drop-performance)
      - [5. Daily Multi-Content-Type Change Detection at Scale](./technical-assumptions.md#5-daily-multi-content-type-change-detection-at-scale)
      - [6. Multi-Tenancy Data Isolation](./technical-assumptions.md#6-multi-tenancy-data-isolation)
  - [Epic List](./epic-list.md)
    - [Epic 1: Foundation & Core Infrastructure](./epic-list.md#epic-1-foundation-core-infrastructure)
    - [Epic 2: Legal Content Foundation](./epic-list.md#epic-2-legal-content-foundation)
  - [Note: Expanded from single-source (SFS laws only) to multi-content-type architecture based on competitive analysis. Court cases and EU legislation critical for SEO coverage.](#note-expanded-from-single-source-sfs-laws-only-to-multi-content-type-architecture-based-on-competitive-analysis-court-cases-and-eu-legislation-critical-for-seo-coverage)
  - [Epic 10: Workspace Onboarding & Invitation Flow](../epics/epic-10-workspace-onboarding.md)
    - [Story 10.1: Post-Auth Workspace Guard & Onboarding Routing](../epics/epic-10-workspace-onboarding.md#story-101-post-auth-workspace-guard--onboarding-routing)
    - [Story 10.2: Workspace Creation Wizard](../epics/epic-10-workspace-onboarding.md#story-102-workspace-creation-wizard)
    - [Story 10.3: Invitation Model & Acceptance Flow](../epics/epic-10-workspace-onboarding.md#story-103-invitation-model--acceptance-flow)
  - [Post-MVP Roadmap (Out of Scope)](./post-mvp-roadmap-out-of-scope.md)
    - [Phase 2: Integration & Automation (Months 7-9)](./post-mvp-roadmap-out-of-scope.md#phase-2-integration-automation-months-7-9)
    - [Phase 3: Public Sector Features (Months 10-12)](./post-mvp-roadmap-out-of-scope.md#phase-3-public-sector-features-months-10-12)
    - [Phase 4: Mobile & Expansion (Months 13+)](./post-mvp-roadmap-out-of-scope.md#phase-4-mobile-expansion-months-13)
    - [Other Deferred Features](./post-mvp-roadmap-out-of-scope.md#other-deferred-features)
  - [Epic 1: Foundation & Core Infrastructure (DETAILED)](./epic-1-foundation-core-infrastructure-detailed.md)
    - [Story 1.1: Initialize Next.js 14 Project with TypeScript and Tailwind](./epic-1-foundation-core-infrastructure-detailed.md#story-11-initialize-nextjs-14-project-with-typescript-and-tailwind)
    - [Story 1.2: Set Up Supabase PostgreSQL Database with Prisma ORM](./epic-1-foundation-core-infrastructure-detailed.md#story-12-set-up-supabase-postgresql-database-with-prisma-orm)
    - [Story 1.3: Implement Authentication (Supabase Auth + NextAuth.js)](./epic-1-foundation-core-infrastructure-detailed.md#story-13-implement-authentication-supabase-auth-nextauthjs)
    - [Story 1.4: Deploy to Vercel with CI/CD Pipeline](./epic-1-foundation-core-infrastructure-detailed.md#story-14-deploy-to-vercel-with-cicd-pipeline)
    - [Story 1.5: Create Initial Law Pages (SSR for SEO) - 100 Laws](./epic-1-foundation-core-infrastructure-detailed.md#story-15-create-initial-law-pages-ssr-for-seo-100-laws)
    - [Story 1.6: Set Up Error Tracking and Logging (Sentry)](./epic-1-foundation-core-infrastructure-detailed.md#story-16-set-up-error-tracking-and-logging-sentry)
    - [Story 1.7: Implement Security Headers (CSP, X-Frame-Options)](./epic-1-foundation-core-infrastructure-detailed.md#story-17-implement-security-headers-csp-x-frame-options)
    - [Story 1.8: Set Up Input Validation (Zod Schemas)](./epic-1-foundation-core-infrastructure-detailed.md#story-18-set-up-input-validation-zod-schemas)
    - [Story 1.9: Create Landing Page with Hero Section](./epic-1-foundation-core-infrastructure-detailed.md#story-19-create-landing-page-with-hero-section)
    - [Story 1.10: Configure Monitoring and Analytics (Vercel Analytics)](./epic-1-foundation-core-infrastructure-detailed.md#story-110-configure-monitoring-and-analytics-vercel-analytics)
  - [Epic 2: Legal Content Foundation (DETAILED)](./epic-2-legal-content-foundation-detailed.md)
  - [Value Delivered: Comprehensive multi-content-type legal library driving massive SEO traffic (170K+ indexable pages) + discovery tools enabling users to find relevant laws, court precedent, and EU compliance requirements + cross-document navigation (laws ↔ cases ↔ EU directives) + historical data collection for Epic 8.](#value-delivered-comprehensive-multi-content-type-legal-library-driving-massive-seo-traffic-170k-indexable-pages-discovery-tools-enabling-users-to-find-relevant-laws-court-precedent-and-eu-compliance-requirements-cross-document-navigation-laws-cases-eu-directives-historical-data-collection-for-epic-8)
  - [Epic 3: RAG-Powered AI Chat Interface (DETAILED)](./epic-3-rag-powered-ai-chat-interface-detailed.md)
    - [Story 3.1: Set Up Vector Database (pgvector + Embeddings)](./epic-3-rag-powered-ai-chat-interface-detailed.md#story-31-set-up-vector-database-pgvector-embeddings)
    - [Story 3.2: Implement RAG Query Pipeline](./epic-3-rag-powered-ai-chat-interface-detailed.md#story-32-implement-rag-query-pipeline)
    - [Story 3.3: Build AI Chat UI with Streaming Responses](./epic-3-rag-powered-ai-chat-interface-detailed.md#story-33-build-ai-chat-ui-with-streaming-responses)
    - [Story 3.4: Implement Drag-and-Drop for Law Cards into Chat](./epic-3-rag-powered-ai-chat-interface-detailed.md#story-34-implement-drag-and-drop-for-law-cards-into-chat)
    - [Story 3.5: Implement Drag-and-Drop for Employee Cards into Chat](./epic-3-rag-powered-ai-chat-interface-detailed.md#story-35-implement-drag-and-drop-for-employee-cards-into-chat)
    - [Story 3.6: Implement Drag-and-Drop for Task Cards into Chat](./epic-3-rag-powered-ai-chat-interface-detailed.md#story-36-implement-drag-and-drop-for-task-cards-into-chat)
    - [Story 3.7: Implement Drag-and-Drop for Files into Chat (Kollektivavtal PDFs)](./epic-3-rag-powered-ai-chat-interface-detailed.md#story-37-implement-drag-and-drop-for-files-into-chat-kollektivavtal-pdfs)
    - [Story 3.8: Implement AI Component Streaming (Law Cards, Task Suggestions)](./epic-3-rag-powered-ai-chat-interface-detailed.md#story-38-implement-ai-component-streaming-law-cards-task-suggestions)
    - [Story 3.9: Add Citation Verification and Hallucination Detection](./epic-3-rag-powered-ai-chat-interface-detailed.md#story-39-add-citation-verification-and-hallucination-detection)
    - [Story 3.10: Implement Chat History and Session Management](./epic-3-rag-powered-ai-chat-interface-detailed.md#story-310-implement-chat-history-and-session-management)
    - [Story 3.11: Optimize AI API Costs with Caching](./epic-3-rag-powered-ai-chat-interface-detailed.md#story-311-optimize-ai-api-costs-with-caching)
    - [Story 3.12: Add Legal Disclaimer and AI Response Warnings](./epic-3-rag-powered-ai-chat-interface-detailed.md#story-312-add-legal-disclaimer-and-ai-response-warnings)
  - [Epic 4: Dynamic Onboarding & Personalized Law Lists (DETAILED)](./epic-4-dynamic-onboarding-personalized-law-lists-detailed.md)
    - [Story 4.1: Build Dynamic Onboarding Widget (Homepage)](./epic-4-dynamic-onboarding-personalized-law-lists-detailed.md#story-41-build-dynamic-onboarding-widget-homepage)
    - [Story 4.2: Integrate Bolagsverket API for Company Data](./epic-4-dynamic-onboarding-personalized-law-lists-detailed.md#story-42-integrate-bolagsverket-api-for-company-data)
    - [Story 4.2b: Implement Dynamic Contextual Questioning Flow](./epic-4-dynamic-onboarding-personalized-law-lists-detailed.md#story-42b-implement-dynamic-contextual-questioning-flow)
    - [Story 4.3: Implement Two-Phase AI-Powered Law List Generation](./epic-4-dynamic-onboarding-personalized-law-lists-detailed.md#story-43-implement-two-phase-ai-powered-law-list-generation)
    - [Story 4.4: Build Streaming Law List UI](./epic-4-dynamic-onboarding-personalized-law-lists-detailed.md#story-44-build-streaming-law-list-ui)
    - [Story 4.4b: Build Post-Signup Phase 2 Completion UI](./epic-4-dynamic-onboarding-personalized-law-lists-detailed.md#story-44b-build-post-signup-phase-2-completion-ui)
    - [Story 4.5: Implement Trial Signup Flow](./epic-4-dynamic-onboarding-personalized-law-lists-detailed.md#story-45-implement-trial-signup-flow)
    - [Story 4.6: Build Email Verification Flow](./epic-4-dynamic-onboarding-personalized-law-lists-detailed.md#story-46-build-email-verification-flow)
    - [Story 4.7: Create Welcome Email Sequence (Trial Nurturing)](./epic-4-dynamic-onboarding-personalized-law-lists-detailed.md#story-47-create-welcome-email-sequence-trial-nurturing)
    - [Story 4.8: Implement Free Trial Expiration Logic](./epic-4-dynamic-onboarding-personalized-law-lists-detailed.md#story-48-implement-free-trial-expiration-logic)
    - [Story 4.9: Add Personalized Law List Management](./epic-4-dynamic-onboarding-personalized-law-lists-detailed.md#story-49-add-personalized-law-list-management)
    - [Story 4.10: Implement Onboarding Progress Tracking](./epic-4-dynamic-onboarding-personalized-law-lists-detailed.md#story-410-implement-onboarding-progress-tracking)
  - [Epic 5: Workspace Management & Team Collaboration (DETAILED)](./epic-5-workspace-management-team-collaboration-detailed.md)
    - [Story 5.1: Implement Workspace Data Model and Multi-Tenancy](./epic-5-workspace-management-team-collaboration-detailed.md#story-51-implement-workspace-data-model-and-multi-tenancy)
    - [Story 5.2: Implement Five User Roles with Permissions](./epic-5-workspace-management-team-collaboration-detailed.md#story-52-implement-five-user-roles-with-permissions)
    - [Story 5.3: Build Team Invite System](./epic-5-workspace-management-team-collaboration-detailed.md#story-53-build-team-invite-system)
    - [Story 5.4: Integrate Stripe for Subscription Billing](./epic-5-workspace-management-team-collaboration-detailed.md#story-54-integrate-stripe-for-subscription-billing)
    - [Story 5.5: Implement Usage Limits Per Tier](./epic-5-workspace-management-team-collaboration-detailed.md#story-55-implement-usage-limits-per-tier)
    - [Story 5.6: Build Add-On Purchase System](./epic-5-workspace-management-team-collaboration-detailed.md#story-56-build-add-on-purchase-system)
    - [Story 5.7: Implement Workspace Settings Page](./epic-5-workspace-management-team-collaboration-detailed.md#story-57-implement-workspace-settings-page)
    - [Story 5.8: Implement Workspace Pause and Deletion](./epic-5-workspace-management-team-collaboration-detailed.md#story-58-implement-workspace-pause-and-deletion)
    - [Story 5.9: Build Workspace Switcher (Multi-Workspace Support)](./epic-5-workspace-management-team-collaboration-detailed.md#story-59-build-workspace-switcher-multi-workspace-support)
    - [Story 5.10: Implement Unit Economics Tracking (NFR18 - CRITICAL)](./epic-5-workspace-management-team-collaboration-detailed.md#story-510-implement-unit-economics-tracking-nfr18-critical)
    - [Story 5.11: Build Workspace Activity Log (Enterprise Feature)](./epic-5-workspace-management-team-collaboration-detailed.md#story-511-build-workspace-activity-log-enterprise-feature)
    - [Story 5.12: Implement Workspace Onboarding Checklist](./epic-5-workspace-management-team-collaboration-detailed.md#story-512-implement-workspace-onboarding-checklist)
  - [Epic 6: Compliance Workspace - Tasks, Evidence & Audit Trail (DETAILED)](./epic-6-compliance-workspace-kanban-dashboard-detailed.md)
    - [Story 6.1: Refactor Dashboard Summary View](./epic-6-compliance-workspace-kanban-dashboard-detailed.md#story-61-refactor-dashboard-summary-view)
    - [Story 6.2: Enhance Law List with Compliance View](./epic-6-compliance-workspace-kanban-dashboard-detailed.md#story-62-enhance-law-list-with-compliance-view)
    - [Story 6.3: Implement Legal Document Modal (Jira-Style Deep Workspace)](./epic-6-compliance-workspace-kanban-dashboard-detailed.md#story-63-implement-legal-document-modal-jira-style-deep-workspace)
    - [Story 6.4: Implement Task Workspace (Jira-Style with Tabs)](./epic-6-compliance-workspace-kanban-dashboard-detailed.md#story-64-implement-task-workspace-jira-style-with-tabs)
    - [Story 6.5: Implement Custom Task Columns](./epic-6-compliance-workspace-kanban-dashboard-detailed.md#story-65-implement-custom-task-columns)
    - [Story 6.6: Implement Task Modal (Jira-Style)](./epic-6-compliance-workspace-kanban-dashboard-detailed.md#story-66-implement-task-modal-jira-style)
    - [Story 6.7: Implement Task Creation Flow](./epic-6-compliance-workspace-kanban-dashboard-detailed.md#story-67-implement-task-creation-flow)
    - [Story 6.8: Implement Evidence Upload System](./epic-6-compliance-workspace-kanban-dashboard-detailed.md#story-68-implement-evidence-upload-system)
    - [Story 6.9: Implement Threaded Comments](./epic-6-compliance-workspace-kanban-dashboard-detailed.md#story-69-implement-threaded-comments)
    - [Story 6.10: Implement Audit Trail & Change Log](./epic-6-compliance-workspace-kanban-dashboard-detailed.md#story-610-implement-audit-trail-change-log)
    - [Story 6.11: Implement Notifications System](./epic-6-compliance-workspace-kanban-dashboard-detailed.md#story-611-implement-notifications-system)
    - [Story 6.12: Implement Global Search (Cmd+K)](./epic-6-compliance-workspace-kanban-dashboard-detailed.md#story-612-implement-global-search-cmdk)
    - [Story 6.13: List Item Responsible Assignment](./epic-6-compliance-workspace-kanban-dashboard-detailed.md#story-613-list-item-responsible-assignment)
  - [Epic 7: HR Module (Employee Management) (DETAILED)](./epic-7-hr-module-employee-management-detailed.md)
    - [Story 7.1: Build Employee List View (CRUD)](./epic-7-hr-module-employee-management-detailed.md#story-71-build-employee-list-view-crud)
    - [Story 7.2: Implement Employee Profile Page with Tabs](./epic-7-hr-module-employee-management-detailed.md#story-72-implement-employee-profile-page-with-tabs)
    - [Story 7.3: Implement CSV Import for Employee Data](./epic-7-hr-module-employee-management-detailed.md#story-73-implement-csv-import-for-employee-data)
    - [Story 7.4: Implement Employee Compliance Status Calculation](./epic-7-hr-module-employee-management-detailed.md#story-74-implement-employee-compliance-status-calculation)
    - [Story 7.5: Implement Kollektivavtal (Collective Agreement) Management](./epic-7-hr-module-employee-management-detailed.md#story-75-implement-kollektivavtal-collective-agreement-management)
    - [Story 7.6: Implement Employee Cards (Draggable to Chat)](./epic-7-hr-module-employee-management-detailed.md#story-76-implement-employee-cards-draggable-to-chat)
    - [Story 7.7: Add Employee Photo Upload](./epic-7-hr-module-employee-management-detailed.md#story-77-add-employee-photo-upload)
    - [Story 7.8: Implement Employee Filters and Sorting](./epic-7-hr-module-employee-management-detailed.md#story-78-implement-employee-filters-and-sorting)
    - [Story 7.9: Build Employee-Law Relationship (Auto-Assignment)](./epic-7-hr-module-employee-management-detailed.md#story-79-build-employee-law-relationship-auto-assignment)
    - [Story 7.10: Implement Employee Offboarding Workflow](./epic-7-hr-module-employee-management-detailed.md#story-710-implement-employee-offboarding-workflow)
    - [Story 7.11: Add Employee Notes and @Mentions](./epic-7-hr-module-employee-management-detailed.md#story-711-add-employee-notes-and-mentions)
    - [Story 7.12: Implement Fortnox Schema Compatibility (FR41)](./epic-7-hr-module-employee-management-detailed.md#story-712-implement-fortnox-schema-compatibility-fr41)
  - [Epic 8: Change Monitoring & Notification System (DETAILED)](./epic-8-change-monitoring-notification-system-detailed.md)
  - [Reference: See for detailed competitor breakdown based on live email examples.](#reference-see-for-detailed-competitor-breakdown-based-on-live-email-examples)
  - [Next Steps](./next-steps.md)
    - [UX Expert Handoff Prompt](./next-steps.md#ux-expert-handoff-prompt)
    - [Architect Handoff Prompt](./next-steps.md#architect-handoff-prompt)
    - [Recommended Next Actions](./next-steps.md#recommended-next-actions)
  - [Document Completion Status](./document-completion-status.md)
